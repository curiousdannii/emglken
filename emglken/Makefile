# Makefile for emglken

# This generates two files. One, of course, is libemglken.a -- the library
# itself. The other is Make.emglken; this is a snippet of Makefile code
# which locates the cheapglk library.
#
# When you install cheapglk, you must put libcheapglk.a in the lib directory,
# and glk.h, glkstart.h, and Make.cheapglk in the include directory.
#
# The file cgunigen.c was generated by the casemap.py script, but
# that step isn't in the Makefile -- you don't have to re-generate it.
# It's based on Unicode character data, which is not platform-dependent.

# Pick a C compiler.
CC = emcc
#CC = gcc -ansi

OPTIONS = -g -Wall

CFLAGS = $(OPTIONS) $(INCLUDEDIRS) -I../cheapglk

GLKLIB = libemglken.a

EMGLKEN_OBJS =  \
  emglken.o ../cheapglk/gi_dispa.o ../cheapglk/gi_debug.o

EMGLKEN_HEADERS = emglken.h ../cheapglk/gi_dispa.h ../cheapglk/gi_debug.h

all: $(GLKLIB) Make.emglken

cgunicod.o: cgunigen.c

$(GLKLIB): $(EMGLKEN_OBJS)
	ar r $(GLKLIB) $(EMGLKEN_OBJS)
	ranlib $(GLKLIB)

Make.emglken:
	echo LINKLIBS = $(LIBDIRS) $(LIBS) > Make.emglken
	echo GLKLIB = -lemglken >> Make.emglken

$(EMGLKEN_OBJS): ../cheapglk/glk.h $(EMGLKEN_HEADERS)

clean:
	rm -f *~ *.o $(GLKLIB) Make.emglken
